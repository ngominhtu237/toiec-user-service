function filter (query, skip) {
  var filters = {};
  var k;

  var SKIP_KEYS = [
    'fields',
    'limit',
    'offset',
    'sort'
  ].concat(skip);

  for (k in query) {
    if (SKIP_KEYS.indexOf(k) === -1) filters[k] = query[k];
  }

  return filters;
}

module.exports = function (options) {
  var o = options || {};

  return function (req, res, next) {
    req.where = filter(req.query, o.skip);
    next();
  };
};
